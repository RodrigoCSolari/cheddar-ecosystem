(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{46601:function(){},73105:function(){},65308:function(){},55024:function(){},9575:function(e,t,n){"use strict";n.d(t,{i:function(){return r}});var a=n(20357);let r=()=>{let e=a.env.NEXT_PUBLIC_NETWORK||"mainnet";switch(e){case"mainnet":return{networkData:{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org",buyCheddarInRefUrl:"https://app.ref.finance/#near|token.cheddar.near",nadaBotUrl:"https://app.nada.bot/",nftImageBaseUrl:"https://bafybeibghcllcmurku7lxyg4wgxn2zsu5qqk7h4r6bmyhpztmyd564cx54.ipfs.dweb.link/"},contracts:{cheddarNft:"nft.cheddar.near",cheddarToken:"token.cheddar.near",nearSocial:"social.near"},socialKeys:{ecosystem:"cheddarEcosystem",mazeVersion:"maze_v0.0.1"},backendBaseUrl:"https://api.cheddar.farm:3002/"};case"testnet":return{networkData:{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org",buyCheddarInRefUrl:"https://testnet.ref.finance/#near|token.cheddar.testnet",nadaBotUrl:"https://testnet.nada.bot/",nftImageBaseUrl:"https://bafybeibghcllcmurku7lxyg4wgxn2zsu5qqk7h4r6bmyhpztmyd564cx54.ipfs.dweb.link/"},contracts:{cheddarNft:"nft.cheddar.testnet",cheddarToken:"token-v3.cheddar.testnet",nearSocial:"v1.social08.testnet"},socialKeys:{ecosystem:"test_cheddarEcosystem",mazeVersion:"maze_v0.0.1"},backendBaseUrl:"https://api.cheddar.farm:3001/"};case"local":return{networkData:{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org",buyCheddarInRefUrl:"https://testnet.ref.finance/#near|token.cheddar.testnet",nadaBotUrl:"https://testnet.nada.bot/",nftImageBaseUrl:"https://bafybeibghcllcmurku7lxyg4wgxn2zsu5qqk7h4r6bmyhpztmyd564cx54.ipfs.dweb.link/"},contracts:{cheddarNft:"nft.cheddar.testnet",cheddarToken:"token-v3.cheddar.testnet",nearSocial:"v1.social08.testnet"},socialKeys:{ecosystem:"test_cheddarEcosystem",mazeVersion:"maze_v0.0.1"},backendBaseUrl:"http://localhost:3001/"};default:throw Error("Unconfigured environment '".concat(e,"'. Can be configured in src/config.js."))}}},86463:function(e,t,n){"use strict";n.d(t,{G:function(){return f},D:function(){return y}});var a=n(57437),r=n(2265),s=n(92379),o=n(42116);class i{nextInt(){return this.state=(this.a*this.state+this.c)%this.m,this.state}nextFloat(){return this.nextInt()/(this.m-1)}nextRange(e,t){return e+Math.floor(this.nextInt()/this.m*(t-e))}choice(e){return e[this.nextRange(0,e.length)]}constructor(e){this.m=2147483648,this.a=1103515245,this.c=12345,this.state=e}}var l=n(90346),c=n(40928),u=n(25443),d=n(19800);let h={cheddarFound:1,bagFound:1,enemyDefeated:1,moveWithoutDying:0},f=(0,r.createContext)({}),y=e=>{let{children:t}=e,n=(0,r.useRef)(!1),{isOpen:y,onOpen:m,onClose:p}=(0,u.q)(),[g,w]=(0,r.useState)([[]]),[v,S]=(0,r.useState)(0),[x,b]=(0,r.useState)({x:1,y:1}),[I,k]=(0,r.useState)(0),[_,C]=(0,r.useState)(!1),[E,T]=(0,r.useState)(""),[U,q]=(0,r.useState)(void 0),[R,F]=(0,r.useState)(!1),[N,P]=(0,r.useState)(null),[z,B]=(0,r.useState)("right"),[O,M]=(0,r.useState)(0),[j,A]=(0,r.useState)(-1),[D,G]=(0,r.useState)(-1),[K,L]=(0,r.useState)(!1),[W,J]=(0,r.useState)(!1),[H,V]=(0,r.useState)(120),[X,Y]=(0,r.useState)(H),[Z,$]=(0,r.useState)(0),[Q,ee]=(0,r.useState)(0),[et,en]=(0,r.useState)(!1),[ea,er]=(0,r.useState)(!1),[es,eo]=(0,r.useState)(!1),[ei,el]=(0,r.useState)(0),[ec,eu]=(0,r.useState)(!1),[ed,eh]=(0,r.useState)({x:-1,y:-1}),[ef,ey]=(0,r.useState)({x:-1,y:-1}),[em,ep]=(0,r.useState)([]),[eg,ew]=(0,r.useState)(0),[ev,eS]=(0,r.useState)(0),[ex,eb]=(0,r.useState)(0),[eI,ek]=(0,r.useState)(new i(0)),[e_,eC]=(0,r.useState)(),[eE,eT]=(0,r.useState)(),[eU,eq]=(0,r.useState)(!0),{isOpen:eR,onOpen:eF,onClose:eN}=(0,u.q)(),{data:eP=0,isLoading:ez,refetch:eB}=(0,l.t6)();(0,r.useEffect)(()=>{let e;S((e=0,g&&g.forEach(t=>{t.forEach(t=>{t.isPath&&e++})}),e))},[g,eL]),(0,r.useEffect)(()=>{let e=Math.floor(X/60),t=X%60;$(e),ee(t)},[X]);let{accountId:eO,selector:eM}=(0,o.s)(),[ej,eA]=(0,r.useState)([]),{data:eD,isLoading:eG}=(0,c.M9)();(0,r.useEffect)(()=>{eO?(0,d.Sf)(eO).then(e=>{eA(e)}):eA([])},[eO]);let eK=()=>Math.floor(Math.floor(3*Math.random())+1);function eL(e){let t=[];return e.map((e,n)=>{e.map((e,a)=>{e.isPath&&t.push({x:a,y:n})})}),t[eI.nextRange(0,t.length)]}async function eW(){if(!eO)return;let e=await (0,s.jn)(eO);await eB(),eb(e.seedId),q(void 0),F(!0),P(Date.now()),k(0),V(120),Y(120),eS(0),en(!1),er(!1),el(0),C(!1),eu(!1),T(""),B("right"),ep([]),eC(void 0),eT(void 0),ew(0),n.current=!1;let t=new i(e.seedId);ek(t);let a=eJ(11,9,t);w(a);let r=eL(a);b({x:r.x,y:r.y}),A(-1),G(-1)}function eJ(e,t,n){let a,r;let s=Array.from({length:e},()=>Array.from({length:t},()=>({isPath:!1,isActive:!1,hasCheese:!1,hasBag:!1,hasEnemy:!1,hasExit:!1,enemyWon:!1,hasCartel:!1})));switch(n.nextRange(0,4)){case 0:a=n.nextRange(1,t-2),r=0;break;case 1:a=t-1,r=n.nextRange(1,e-2);break;case 2:a=n.nextRange(1,t-2),r=e-1;break;case 3:a=0,r=n.nextRange(1,e-2)}s[r][a].isPath=!0;let o=[[a,r]];for(;o.length;){let[a,r]=o[o.length-1],i=[];if([[2,0],[-2,0],[0,2],[0,-2]].forEach(n=>{let[o,l]=n,c=a+o,u=r+l;c>=0&&c<t&&u>=0&&u<e&&!s[u][c].isPath&&i.push([c,u,a+o/2,r+l/2])}),i.length){let[e,t,a,r]=i[n.nextRange(0,i.length)];s[t][e].isPath=!0,s[r][a].isPath=!0,o.push([e,t])}else o.pop()}return s}function eH(e,t){if(!g[t]||!g[t][e]||!g[t][e].isPath)return;let n=g.map((n,a)=>n.map((n,r)=>({...n,isActive:a===t&&r===e})));n[x.y][x.x].isActive=!1,b({x:e,y:t}),w(n),el(ei+1),em.includes("".concat(e).concat(t))||(em.push("".concat(e).concat(t)),ep(em)),function(e,t,n,a){if(_||g[t][e].hasCheese||g[t][e].hasBag||g[t][e].hasEnemy||g[t][e].hasCartel||g[t][e].hasExit)return;let r=[...n];eI.nextFloat()<(ej.length>0?10*eV.exit:eV.exit)&&em.length>=.75*v||v-eg==1?(r[t][e].hasExit=!0,ew(eg+1),eX("Congrats! You found the Hidden Door.",!0)):!es&&eI.nextFloat()<eV.enemy?(ew(eg+1),.02>eI.nextFloat()?(r[t][e].enemyWon=!0,r[t][e].isActive=!1,eX("Enemy won! Game Over!",!1)):(r[t][e].hasEnemy=!0,k(I+h.enemyDefeated),setTimeout(()=>{},eI.nextRange(1e3,6e3)))):!et&&eI.nextFloat()<(ej.length>0?1.28*eV.cheese:eV.cheese)?(r[t][e].hasCheese=!0,ew(eg+1),k(I+h.cheddarFound),eS(ev+1),en(!0),setTimeout(()=>{en(!1)},eI.nextRange(1e3,6e3))):!ea&&eI.nextFloat()<eV.bag?(r[t][e].hasBag=!0,ew(eg+1),k(I+h.bagFound),eS(ev+5),er(!0),setTimeout(()=>{er(!1)},eI.nextRange(1e3,11e3))):eI.nextFloat()<eV.cartel?(r[t][e].hasCartel=!0,ew(eg+1),eX("You ran into the cartel! Game Over!",!1)):k(I+h.moveWithoutDying),w(r)}(e,t,n,0),A(x.x),G(x.y)}(0,r.useEffect)(()=>{let e=eJ(11,9,new i(0));w(e),M(eK());let t=eL(e);b({x:t.x,y:t.y})},[]);let eV={exit:.002,enemy:.19,cheese:.055,bag:.027,cartel:2e-4};async function eX(e,t){if(n.current)return;n.current=!0,q(t),ep([]),C(!0),T(e),F(!1);let a=await (0,s.qO)({data:{cheddarEarned:t?ev<=eP?ev:eP:0,score:I,path:[]},metadata:{accountId:eO,seedId:ex}});eT(a),a.ok||eC(a.errors)}function eY(e){if(_)return;let t=x.x,n=x.y;switch(e){case"ArrowUp":n--,B("up");break;case"ArrowDown":n++,B("down");break;case"ArrowLeft":t--,B("left");break;case"ArrowRight":t++,B("right");break;default:return}eH(t,n),A(x.x),G(x.y)}function eZ(e){if(e){let t=function(e){let t=e.slice(5).split("-");return{y:Number(t[0]),x:Number(t[1])}}(e);if(function(e){let t=g[e.y][e.x].isPath,n=(x.y+1===e.y||x.y-1===e.y)&&x.x===e.x||(x.x+1===e.x||x.x-1===e.x)&&x.y===e.y;return t&&n}(t)){let e=x.x,n=x.x-t.x,a=x.y,r=x.y-t.y,s="";1===n?(s="left",e--):-1===n?(s="right",e++):1===r?(s="up",a--):-1===r&&(s="down",a++),B(s),eH(e,a),A(x.x),G(x.y)}}}(0,r.useEffect)(()=>{let e=null;return R&&!_&&N?e=setInterval(()=>{Y(t=>t<=0&&e?(clearInterval(e),P(null),eX("â° Time's up! Game Over!",!1),t):Math.floor(N/1e3+H-Date.now()/1e3))},500):e&&clearInterval(e),()=>{e&&clearInterval(e)}},[R,_]);let e$=e=>{let t=document.elementFromPoint(e.clientX,e.clientY);return(null==t?void 0:t.id)||""},{data:eQ,isLoading:e0}=(0,l.RH)();return(0,a.jsx)(f.Provider,{value:{mazeData:g,setMazeData:w,playerPosition:x,setPlayerPosition:b,score:I,setScore:k,gameOverFlag:_,setGameOverFlag:C,gameOverMessage:E,setGameOverMessage:T,timerStarted:R,setTimerStarted:F,direction:z,setDirection:B,selectedColorSet:O,setSelectedColorSet:M,lastCellX:j,setLastCellX:A,lastCellY:D,setLastCellY:G,hasPowerUp:K,setHasPowerUp:L,isPowerUpOn:W,setIsPowerUpOn:J,timeLimitInSeconds:H,setTimeLimitInSeconds:V,remainingTime:X,setRemainingTime:Y,remainingMinutes:Z,setRemainingMinutes:$,remainingSeconds:Q,setRemainingSeconds:ee,cheeseCooldown:et,setCheeseCooldown:en,bagCooldown:ea,setBagCooldown:er,enemyCooldown:es,setEnemyCooldown:eo,moves:ei,setMoves:el,won:ec,setWon:eu,touchStart:ed,setTouchStart:eh,touchEnd:ef,setTouchEnd:ey,coveredCells:em,setCoveredCells:ep,mazeRows:11,mazeCols:9,totalCells:99,pathLength:v,handleKeyPress:function(e){eY(e.key)},handleArrowPress:function(e){eY(e)},restartGame:eW,calculateBlurRadius:function(e,t){return 0},handleTouchStart:e=>{if(!eU){let t=e$(e.touches[0]);_||eZ(t)}},handleTouchMove:e=>{if(!eU){e.preventDefault();let t=e.touches;for(let e=0;e<t.length;e++){let n=e$(t[e]);!_&&n&&eZ(n)}}},cheddarFound:ev,saveResponse:e_,hasWon:U,pendingCheddarToMint:eP,endGameResponse:eE,videoModalOpened:eR,onOpenVideoModal:eF,onCloseVideoModal:eN,nfts:ej,showMovementButtons:eU,setShowMovementButtons:eq,scoreboardResponse:eQ,isLoadingScoreboard:e0,isScoreboardOpen:y,onOpenScoreboard:m,onCloseScoreboard:p},children:t})}},42116:function(e,t,n){"use strict";n.d(t,{S:function(){return w},s:function(){return v}});var a,r,s=n(57437),o=n(2265),i=n(65690),l=n(39864),c=n(6562),u=n(59239),d=n(50160),h=n(919),f=n(95725),y=n(63336);let m=(0,n(77902).M)(()=>({selector:null,modal:null,account_id:null,wallet:null}));var p=n(9575);(a=r||(r={})).Here="here",a.Meteor="meteor",a.MyNearWallet="mynearwallet",a.MintBase="mintbase";let g=o.createContext(null),w=e=>{var t;let{children:n}=e,{networkData:a}=(0,p.i)(),r=a.networkId,[w,v]=(0,o.useState)(null),[S,x]=(0,o.useState)(null),[b,I]=(0,o.useState)([]),k=["mynearwallet","meteor","here","mintbase"],_=(0,o.useCallback)(()=>{let e=[];return k.forEach(t=>{switch(t){case"meteor":e.push((0,f.Z)());break;case"mynearwallet":e.push((0,h.X)());break;case"here":e.push((0,d.v)());break;case"mintbase":e.push((0,y.h)())}}),e},[k,r]),C=(0,o.useCallback)(async()=>{var e,t;let n=await (0,c.L1)({network:r,debug:!0,modules:_()}),a=(0,u.D)(n,{contractId:""});I(n.store.getState().accounts),m.setState({selector:n,modal:a,account_id:n.isSignedIn()&&(null===(e=n.store.getState().accounts.find(e=>e.active))||void 0===e?void 0:e.accountId)||null,wallet:n.isSignedIn()?await n.wallet():null}),window.selector=n,window.modal=a,window.account_id=n.isSignedIn()&&(null===(t=n.store.getState().accounts.find(e=>e.active))||void 0===t?void 0:t.accountId)||null,window.wallet=n.isSignedIn()?await n.wallet():null,v(n),x(a)},[r,_]);if((0,o.useEffect)(()=>{C().catch(e=>{console.error(e),alert("Failed to initialise wallet selector")})},[C]),(0,o.useEffect)(()=>{if(!w)return;let e=w.store.observable.pipe((0,i.U)(e=>e.accounts),(0,l.x)()).subscribe(async e=>{var t;let n=w.isSignedIn()?await w.wallet():null;I(e),m.setState(t=>{var a;return{modal:S,selector:w,wallet:n,account_id:null===(a=e.find(e=>e.active))||void 0===a?void 0:a.accountId}}),window.account_id=null===(t=e.find(e=>e.active))||void 0===t?void 0:t.accountId});return()=>e.unsubscribe()},[w,S]),!w||!S)return null;let E=(null===(t=b.find(e=>e.active))||void 0===t?void 0:t.accountId)||null;return(0,s.jsx)(g.Provider,{value:{selector:w,modal:S,accounts:b,accountId:E},children:n})};function v(){let e=(0,o.useContext)(g);if(!e)throw Error("useWalletSelector must be used within a WalletSelectorContextProvider");return e}},19800:function(e,t,n){"use strict";n.d(t,{E6:function(){return l},Sf:function(){return u},Tc:function(){return c},Tr:function(){return h},WU:function(){return d},vJ:function(){return i}});var a=n(9575),r=n(13581);let{cheddarToken:s,cheddarNft:o}=(0,a.i)().contracts,i=async e=>(0,r.ei)(s,"ft_balance_of",{account_id:e}).then(BigInt),l=async()=>(0,r.ei)(s,"ft_total_supply").then(BigInt),c=async()=>(0,r.ei)(s,"ft_metadata"),u=async e=>(0,r.ei)(o,"nft_tokens_for_owner",{account_id:e}),d=async(e,t,n)=>{let r=(0,a.i)().contracts.cheddarToken;return t?e.signAndSendTransactions({transactions:[{receiverId:r,actions:[{type:"FunctionCall",params:{methodName:"ft_transfer_call",args:{receiver_id:o,amount:n,msg:""},gas:"300"+"0".repeat(12),deposit:"1"}}]},{receiverId:o,actions:[{type:"FunctionCall",params:{methodName:"nft_mint_one",args:{with_cheddar:!0},gas:"300"+"0".repeat(12),deposit:"1"+"0".repeat(21)}}]}]}):e.signAndSendTransaction({receiverId:o,actions:[{type:"FunctionCall",params:{methodName:"nft_mint_one",args:{with_cheddar:!1},gas:"300"+"0".repeat(12),deposit:n}}]})},h=(e,t)=>(0,r.ei)(o,"total_cost",{num:1,minter:e,with_cheddar:t})},13581:function(e,t,n){"use strict";n.d(t,{ei:function(){return s},nq:function(){return l},qc:function(){return i}});var a=n(9575);let r=0;async function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o("query",{request_type:"call_function",account_id:e,method_name:t,args_base64:btoa(JSON.stringify(n)),finality:"optimistic"})}async function o(e,t){let n=(0,a.i)(),s={body:JSON.stringify({method:e,params:t,id:++r,jsonrpc:"2.0"}),method:"POST",headers:{"Content-type":"application/json; charset=utf-8"}},o=await fetch(n.networkData.nodeUrl,s);return JSON.parse(function(e){let t=[];for(let n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return decodeURIComponent(escape(t.join("")))}((await o.json()).result.result))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;if(!(e=e.toString()))return 0;if(-1!==e.indexOf("."))throw Error("a yocto string can't have a decimal point: "+e);let a=!1;e.startsWith("-")&&(a=!0,e=e.slice(1));let r=e.padStart(t+1,"0");return Number(r.slice(0,-t)+"."+r.slice(-t,-t+n))*(a?-1:1)}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;return BigInt(Math.round(1e6*e).toString()+"0".repeat(t-6))}},40928:function(e,t,n){"use strict";n.d(t,{LI:function(){return u},M9:function(){return l},d$:function(){return i},eV:function(){return o},mE:function(){return c}});var a=n(42116),r=n(19800),s=n(55355);let o=()=>{let{accountId:e}=(0,a.s)();return(0,s.a)({queryKey:["useGetCheddarBalance",e],queryFn:()=>e?(0,r.vJ)(e):null,refetchInterval:1e4,staleTime:1e4})},i=()=>(0,s.a)({queryKey:["useGetCheddarMetadata"],queryFn:()=>(0,r.Tc)(),refetchInterval:1/0,staleTime:1/0}),l=()=>{let{accountId:e}=(0,a.s)();return(0,s.a)({queryKey:["useGetCheddarNFTs",e],queryFn:()=>e?(0,r.Sf)(e):null,refetchInterval:1e4,staleTime:1e4})},c=()=>(0,s.a)({queryKey:["useGetCheddarTotalSupply"],queryFn:()=>(0,r.E6)(),refetchInterval:1e4,staleTime:1e4}),u=e=>{let{accountId:t}=(0,a.s)();return(0,s.a)({queryKey:["useGetCheddarNFTs",t,e],queryFn:()=>t?(0,r.Tr)(t,e):null,refetchInterval:1e4,staleTime:1e4})}},90346:function(e,t,n){"use strict";n.d(t,{RH:function(){return i},_p:function(){return o},t6:function(){return l}});var a=n(42116),r=n(92379),s=n(55355);let o=()=>{let{accountId:e}=(0,a.s)();return(0,s.a)({queryKey:["useGetIsAllowed",e],queryFn:()=>e?(0,r.yy)(e):null,refetchInterval:1e4,staleTime:1e4})},i=()=>(0,s.a)({queryKey:["useGetScoreboard"],queryFn:()=>(0,r.Eg)(),refetchInterval:1e4,staleTime:1e4}),l=()=>{let{accountId:e}=(0,a.s)();return(0,s.a)({queryKey:["useGetPendingCheddarToMint",e],queryFn:()=>e?(0,r.ZE)(e):null,refetchInterval:1e4,staleTime:1e4})}},92379:function(e,t,n){"use strict";n.d(t,{Eg:function(){return i},ZE:function(){return s},jn:function(){return o},qO:function(){return l},yy:function(){return r}});let{backendBaseUrl:a}=(0,n(9575).i)();async function r(e){let t=new URL("api/maze/isAllowed?accountId=".concat(e),a).toString(),n=await fetch(t);return await n.json()}async function s(e){let t=new URL("api/maze/pendingCheddar?accountId=".concat(e),a).toString(),n=await fetch(t),r=await n.json();return r.ok?r.pendingCheddarToMint:0}async function o(e){let t=new URL("api/maze/getSeedId",a).toString();return(await fetch(t,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({accountId:e})})).json()}async function i(){let e=new URL("/api/maze/scoreboard",a).toString(),t=await fetch(e);return await t.json()}async function l(e){let t=new URL("api/maze/endGame",a).toString();return(await fetch(t,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}}}]);